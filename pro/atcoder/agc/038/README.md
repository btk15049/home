# AtCoder Grand Contest 038

writer:marronrk

## A

- R 行のうち，白が A 個である行の数を S とする
- C 列のうち，白が B 個である行の数を T とする

必要条件は，明らかに `S * A + (R - S) * (C - A)= T \* B + (C - T) \* (R - B)`
よく考えると，この必要条件は十分条件になる．次のように盤面を構成すれば良い

1...S 行目は白を A 個，その他の行は黒を A 個置くとする
同様に，1...T 行目は白を B 個，その他の列は黒を B 個置くとする
次の操作を左上の駒から順に行うことで，目的の盤面を構成できる

- まだその(行，列)に白い駒をおけるならば白い駒を置く
- そうでないならば黒い駒を置く

## B

[i, i+K)と[i+1, i+K+1)で列が同じかどうかに着目すると，

- [i, i+K)のうち i 番目の要素が最小
- [i+1, i+K+1)のうち i+K 番目の要素が最大

の両方を満たしている場合，できる列は同一となる．

また，[i, i+K)と[j, j+K)の列は，

- [i, i+K) , [j, j+K)がともに昇順

の場合にもできる列が同一となる．

同一な列をうまく数えて，N-K+1 から引けば答えが出る．

## C

10^6 log (10^6) + N \* |約数の個数|^2
でぶん殴る(1977ms)

## D

解説そのままになった．
最初，C=0 の頂点を UF, C=1 の頂点を別の UF で管理
みたいなことをして大変な目にあった

## E

見てない

## F

「順列はサイクルの集合（素振り）」を使うと，燃やす埋めるになる．
yosupo ブログを見て燃やす埋めるをうまく構成すれば解ける．
素直に解こうとすると，

- 「X を赤，Y を青にすると報酬」
- 「X を赤，Y を赤にすると報酬」

の 2 つが必要になるが，後者は最大カットになるので不可能
なので，P,Q,i のイコールの関係を場合分けしてやると，5 パターンになって，

- X を赤にすると報酬
- X を赤，Y を赤にすると罰金

のみでいけるようになるこのままだと解けないが，二部グラフ性を生かして，Q 側の頂点の操作を反転してやると

- X を赤にすると報酬
- X を青にすると報酬
- X を赤，Y を青にすると罰金

として解けるようになる

明らかに D>>>F

### 新しく学んだこと

- 燃やす埋めるの操作をライブラリ化したほうがよい
